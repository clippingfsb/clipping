<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clipping de Not√≠cias</title>
  <style>
    :root {
      --primary-color: #4a90e2;
      --secondary-color: #f5f7fa;
      --accent-color: #34c759;
      --danger-color: #ff3b30;
      --warning-color: #ffcc00;
      --text-main: #2c3e50;
      --text-muted: #7f8c8d;
      --bg-card: #ffffff;
      --border-color: #dcdde1;
      --shadow: 0 4px 6px rgba(0,0,0,0.05), 0 1px 3px rgba(0,0,0,0.1);
      --font-size-base: 1.1rem;
      --font-size-small: 0.95rem;
      --font-size-title: 1rem;
    }
    body {
      background-color: #f0f2f5;
      color: var(--text-main);
      font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 15px;
      line-height: 1.4;
      font-size: var(--font-size-base);
    }
    .container { max-width: 1100px; margin: 0 auto; }
    .title {
      font-weight: 700;
      color: var(--text-main);
      font-size: var(--font-size-title);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin: 0 0 6px 0;
    }
    .cors-instruction {
      background-color: #fff3cd;
      border-left: 5px solid var(--warning-color);
      color: #856404;
      padding: 10px 20px;
      border-radius: 8px;
      margin-bottom: 15px;
      font-size: var(--font-size-small);
      box-shadow: var(--shadow);
    }
    .cors-instruction a { color: #856404; font-weight: bold; text-decoration: underline; }
    .section-form, .section-tabela {
      background-color: var(--bg-card);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: var(--shadow);
    }
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px 20px;
    }
    .form-group { margin-bottom: 12px; }
    .form-group.full-width { grid-column: 1 / -1; }
    input, textarea, select {
      background-color: #f8f9fa;
      color: var(--text-main);
      border: 2px solid var(--border-color);
      border-radius: 8px;
      padding: 10px 15px;
      width: 100%;
      box-sizing: border-box;
      font-size: var(--font-size-base);
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 4px rgba(74,144,226,0.15);
    }
    textarea#tag-input { min-height: 200px; resize: vertical; }
    .radio-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      background: #f8f9fa;
      padding: 8px;
      border-radius: 8px;
      border: 2px solid var(--border-color);
    }
    .radio-option {
      display: flex;
      align-items: center;
      cursor: pointer;
      padding: 6px 15px;
      border-radius: 6px;
      transition: background 0.2s;
    }
    .radio-option:hover { background: #edf2f7; }
    .radio-option input { width: auto; margin-right: 8px; transform: scale(1.1); }
    .radio-option label { cursor: pointer; font-weight: 500; font-size: var(--font-size-base); }
    .radio-option input:checked + label { color: var(--primary-color); font-weight: 700; }
    .btn-container {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    .btn {
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      font-size: var(--font-size-base);
      font-weight: 500;
      border-radius: 8px;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      height: 42px;
      white-space: nowrap;
    }
    .btn-success { background-color: var(--accent-color); color: white; box-shadow: 0 3px 8px rgba(52,199,89,0.2); }
    .btn-success:hover { background-color: #2fb34f; transform: translateY(-1px); }
    .btn-outline { background-color: transparent; border: 2px solid var(--border-color); color: var(--text-muted); }
    .btn-outline:hover { border-color: var(--primary-color); color: var(--primary-color); }
    #btn-colar-link {
      background-color: var(--primary-color);
      color: white;
    }
    #btn-colar-link:hover {
      background-color: #357abd;
      transform: translateY(-1px);
    }
    #btn-colar-materia {
      display: block;
      margin: 12px auto 0;
      background-color: #10b981;
      color: white;
      width: auto;
      min-width: 180px;
    }
    #btn-colar-materia:hover {
      background-color: #059669;
      transform: translateY(-1px);
    }
    .shortlink-container {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }
    .shortlink-container input {
      flex: 3;
      min-width: 250px;
    }
    .shortlink-container .btn {
      flex: 1;
      min-width: 160px;
    }
    .preview-box {
      background-color: #f8f9fa;
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 15px;
      margin-top: 15px;
      position: relative;
    }
    .preview-content {
      white-space: pre-wrap;
      font-size: var(--font-size-base);
      color: #333;
      min-height: 60px;
      line-height: 1.4;
    }
    .preview-actions {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 2px solid var(--border-color);
    }
    .table-wrapper { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th {
      text-align: left;
      padding: 12px 15px;
      background-color: #f8f9fa;
      color: var(--text-muted);
      font-size: var(--font-size-small);
      text-transform: uppercase;
      border-bottom: 3px solid var(--border-color);
    }
    td {
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
      vertical-align: top;
    }
    tr:hover { background-color: #fafafa; }
    .materia-cell {
      font-size: var(--font-size-small);
      white-space: pre-wrap;
      word-break: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
      line-height: 1.45;
    }
    #loading {
      font-weight: 800;
      color: var(--primary-color);
      margin-left: 10px;
      display: none;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse { 0%,100% {opacity:0.6} 50% {opacity:1} }
    .auto-filled {
      border: 2px solid #ffcc00 !important;
      background-color: #fffacd !important;
    }
    /* RESPONSIVIDADE MOBILE */
    @media (max-width: 768px) {
      body { padding: 10px; font-size: 1rem; }
      .form-grid { grid-template-columns: 1fr; gap: 16px; }
      #btn-colar-materia { width: 100%; max-width: 260px; margin: 16px auto 0; }
      .btn-container, .shortlink-container, .preview-actions {
        flex-direction: column;
        gap: 12px;
        align-items: stretch;
      }
      .shortlink-container input, .shortlink-container .btn, .btn { width: 100%; }
      .table-wrapper { overflow-x: hidden; }
      #materias-tabela thead { display: none; }
      #materias-tabela tr {
        display: block;
        margin-bottom: 24px;
        border: 1px solid #ddd;
        border-radius: 12px;
        background: white;
        box-shadow: 0 3px 8px rgba(0,0,0,0.08);
      }
      #materias-tabela td {
        display: block;
        padding: 16px;
        border-bottom: 1px solid #f0f0f0;
        position: relative;
        padding-left: 40%;
      }
      #materias-tabela td:before {
        content: attr(data-label);
        position: absolute;
        left: 16px;
        top: 16px;
        width: 35%;
        font-weight: 600;
        color: #444;
        font-size: 1rem;
        white-space: nowrap;
      }
      #materias-tabela td[data-label="Data/Hora"]:before { content: "Data/Hora"; }
      #materias-tabela td[data-label="Mat√©ria Completa"]:before {
        content: "Mat√©ria Completa";
        white-space: normal;
        line-height: 1.3;
        width: 35%;
      }
      #materias-tabela td:last-child {
        border-bottom: none;
        padding: 16px;
        display: flex !important;
        justify-content: center !important;
        align-items: center;
        gap: 32px;
        flex-wrap: nowrap;
      }
      .materia-cell {
        padding-left: 40% !important;
        overflow-wrap: break-word;
        hyphens: auto;
      }
      #materias-tabela .btn-outline {
        flex: 0 0 auto;
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
        padding: 0;
        border-radius: 12px;
        background: #f8f9fa;
        border: 1px solid #ccc;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s;
      }
      #materias-tabela .btn-outline:hover,
      #materias-tabela .btn-outline:active {
        background: #e8e8e8;
      }
    }
    @media (max-width: 480px) {
      #materias-tabela td { padding-left: 45%; }
      #materias-tabela td:before { width: 40%; }
      .materia-cell { padding-left: 45% !important; }
      #materias-tabela td:last-child { gap: 24px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="cors-instruction">
      <p><strong>Importante:</strong> Para extra√ß√£o autom√°tica, primeiro ative o acesso tempor√°rio em <a href="https://cors-anywhere.herokuapp.com/" target="_blank">cors-anywhere.herokuapp.com</a>, clicando em <strong>‚ÄúRequest temporary access to the demo server‚Äù</strong>. Depois volte a esta p√°gina e cole o link encurtado no campo correspondente.</p>
    </div>
    <section class="section-form">
      <div class="form-grid">
        <div class="form-group full-width">
          <p class="title">Classifica√ß√£o</p>
          <div class="radio-group" id="classificacao">
            <div class="radio-option"><input type="radio" name="classificacao" id="option1" value="üóû" /><label for="option1">Impresso</label></div>
            <div class="radio-option"><input type="radio" name="classificacao" id="option2" value="üåê" checked /><label for="option2">Online Nacional</label></div>
            <div class="radio-option"><input type="radio" name="classificacao" id="option5" value="üåê" /><label for="option5">Internacional</label></div>
            <div class="radio-option"><input type="radio" name="classificacao" id="option3" value="üì∫" /><label for="option3">TV</label></div>
            <div class="radio-option"><input type="radio" name="classificacao" id="option4" value="üìª" /><label for="option4">R√°dio</label></div>
          </div>
        </div>
        <div class="form-group full-width">
          <p class="title">Link curto (cole aqui para preencher os campos abaixo automaticamente) <span id="loading">Processando...</span></p>
          <div class="shortlink-container">
            <input id="link-curto" type="text" placeholder="Cole o link encurtado aqui">
            <div class="btn-container">
              <button class="btn btn-secondary" id="btn-colar-link" type="button">Colar link curto</button>
            </div>
          </div>
        </div>
        <div class="form-group">
          <p class="title">Ve√≠culo</p>
          <input class="veiculos" type="text" placeholder="Ex: CNN Brasil online" list="veiculo-dropdown" />
          <datalist id="veiculo-dropdown"></datalist>
        </div>
        <div class="form-group">
          <p class="title">Blog / Coluna</p>
          <input class="blog-coluna" type="text" placeholder="Ex: Tain√° Falc√£o" list="coluna-dropdown" />
          <datalist id="coluna-dropdown"></datalist>
        </div>
        <div class="form-group full-width">
          <p class="title">Not√≠cia</p>
          <textarea id="tag-input" placeholder="Digite ou cole a not√≠cia aqui..."></textarea>
          <button class="btn btn-secondary" id="btn-colar-materia" type="button">üìÑ Colar not√≠cia</button>
        </div>
        <div class="form-group full-width">
          <p class="title">Data/Hora de Publica√ß√£o <small>(obrigat√≥ria para Comunica√ß√µes - DD/MM/YYYY HH:MM)</small></p>
          <input id="data-hora-publicacao" type="text" placeholder="Ex: 26/01/2026 14:30" />
        </div>
        <div class="form-group">
          <p class="title">Cargo</p>
          <select id="tipo-ministro">
            <option value="nenhum">Nenhum</option>
            <option value="presidente">Presidente</option>
            <option value="ministro">Ministro</option>
            <option value="ministra">Ministra</option>
          </select>
        </div>
        <div class="form-group">
          <p class="title">√ìrg√£o / Minist√©rio</p>
          <select id="ministerio">
            <option value="">Selecionar o √≥rg√£o</option>
          </select>
        </div>
      </div>
      <div class="preview-box">
        <p class="title" style="color: var(--primary-color)">Pr√©via da Mensagem</p>
        <div id="preview-area" class="preview-content"></div>
        <div class="preview-actions">
          <button class="btn btn-success btn-copiar">‚Üí Gerar e Copiar</button>
          <button class="btn btn-outline btn-resetar">√ó Limpar</button>
          <button class="btn btn-outline btn-desfazer">‚Ü∫ Desfazer</button>
        </div>
      </div>
    </section>
    <section class="section-tabela">
      <h2 class="title" style="font-size: 1.2rem; margin-bottom: 15px;">Hist√≥rico de mensagens</h2>
      <div class="table-wrapper">
        <table id="materias-tabela">
          <thead>
            <tr>
              <th style="width: 140px;">Data/Hora</th>
              <th>Mensagem gerada</th>
              <th style="width: 110px;">A√ß√µes</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
  <script>
    "use strict";
    let blueParrot = {
      link: "", classifica√ß√£o: "üåê ", veiculo: "", coluna: "", tags: "",
      linkCurto: "", tipoMinistro: "nenhum", ministerio: "",
      ministerioStr: "", alertaPrefix: "",
      dataHoraPublicacao: "",
      dataHoraPublicacaoExtraida: ""
    };
    let backup = {};
    const linkCurto = document.querySelector("#link-curto");
    const radioButtons = document.querySelectorAll("input[name='classificacao']");
    const veiculos = document.querySelector(".veiculos");
    const blogColuna = document.querySelector(".blog-coluna");
    const tagInput = document.querySelector("#tag-input");
    const dataHoraInput = document.querySelector("#data-hora-publicacao");
    const tipoMinistroSelect = document.querySelector("#tipo-ministro");
    const ministerioSelect = document.querySelector("#ministerio");
    const loading = document.querySelector("#loading");
    const previewArea = document.querySelector("#preview-area");
    const vehiclesByClassification = {
      "Impresso": ["Folha de S.Paulo", "O Estado de S. Paulo", "O Globo", "Valor Econ√¥mico", "Correio Braziliense"],
      "Online Nacional": [
       "Ag√™ncia Brasil", "Ag√™ncia C√¢mara", "Ag√™ncia Senado", "BBC News Brasil", "Bloomberg Brasil",
        "Bloomberg L√≠nea", "Brasil 247", "Carta Capital online", "CBN", "CNN Brasil online",
        "Congresso em Foco", "Correio Braziliense online", "Cruso√©", "√âpoca Neg√≥cios", "√âpoca Online",
        "Estad√£o online", "Exame on-line", "Exame online", "Extra online", "FDR", "Folha online",
        "g1", "ICL Not√≠cias", "iG", "InfoMoney", "Isto√â Dinheiro online", "Isto√â online",
        "Jota", "Jovem Pan online", "Metr√≥poles", "Money Times", "O Antagonista", "O Bastidor",
        "O Globo online", "Plat√¥BR", "Poder360", "R7", "Terra", "UOL", "Valor Investe", "Valor online",
        "Veja online", "Yahoo!"
      ],
      "Internacional": [
        "AFP ‚Äì Agence France Presse", "Ag√™ncia EFE", "Ag√™ncia EFE ‚Äì Espanhol", "Ag√™ncia EFE ‚Äì Ingl√™s",
        "Ag√™ncia Xinhua", "ANSA Brasil", "Associated Press", "BBC News", "Bloomberg", "Bloomberg Markets",
        "CCTV News", "CGTN Online", "Chicago Tribune", "Clar√≠n Online ‚Äì Argentina", "Corriere della Sera",
        "Corriere della Sera Online", "Daily Maverick ‚Äì √Åfrica do Sul", "Daily Sabah ‚Äì Turquia", "Dallas News",
        "Dan Tri", "De Telegraaf", "Der Spiegel Online", "Deutsche Welle", "Diario Clar√≠n ‚Äì Argentina",
        "Die Zeit", "El Comercio ‚Äì Equador", "El Comercio ‚Äì Peru", "El Comercio Online ‚Äì Peru", "El Mercurio",
        "El Nacional Online ‚Äì Venezuela", "El Pa√≠s ‚Äì Espanha", "El Pa√≠s ‚Äì Uruguai", "El Pa√≠s Online ‚Äì Espanha",
        "El Pa√≠s Online ‚Äì Uruguai", "El Tiempo ‚Äì Col√¥mbia", "El Universal ‚Äì M√©xico", "El Universal ‚Äì Venezuela",
        "El Universal Diario ‚Äì Venezuela", "Expresso", "Financial Times Online", "Foreign Affairs", "Foreign Policy",
        "Fox Business", "Fox News", "France 24 Online", "Frankfurter Allgemeine Zeitung", "Global Times", "Jiji",
        "Jornal de Angola", "Jornal Expans√£o Online", "Kyodo", "La Naci√≥n ‚Äì Argentina", "La Naci√≥n ‚Äì Paraguai",
        "La Naci√≥n Online ‚Äì Argentina", "La Naci√≥n Online ‚Äì Paraguai", "La Raz√£o Online ‚Äì Bol√≠via",
        "La Rep√∫blica ‚Äì Peru", "Le Courrier du Vietnam", "Le Figaro", "Le Figaro Online", "Le Monde Online",
        "Les Echos Online", "Lib√©ration", "Los Angeles Times", "Los Angeles Times Online", "M√©xico ‚Äì El Universal Online",
        "Nation ‚Äì Qu√™nia", "Nature Online", "Nh√£n D√¢n", "Nikkei", "Not√≠cias Mo√ßambique", "Novo Jornal ‚Äì Angola",
        "P√°gina Siete Online ‚Äì Bol√≠via", "Politico Online", "P√∫blico ‚Äì Portugal", "Reuters", "SABC News ‚Äì √Åfrica do Sul",
        "South China Morning Post ‚Äì Hong Kong", "Sputnik News", "TBS ‚Äì Jap√£o", "TBS News Dig", "The Economist",
        "The Epoch Times", "The Globe and Mail", "The Globe and Mail Online", "The Guardian", "The Guardian ‚Äì Nig√©ria",
        "The Hindu", "The Jakarta Post", "The Jerusalem Post", "The Korea Times Online", "The New York Times",
        "The New York Times Online", "The Spectator", "The Sydney Morning Herald", "The Telegraph Online",
        "The Tehran Times", "The Times ‚Äì √Åfrica do Sul", "The Times of India", "The Wall Street Journal",
        "The Wall Street Journal Online", "The Washington Post", "The Washington Post Online", "The Washington Times",
        "The Yomiuri Shimbun", "Tuoi Tre Online", "USA Today", "Vanguard ‚Äì Nig√©ria", "Viet Nam News", "VN Express"
      ],
      "TV": ["TV AgroMais", "TV BandNews", "TV Band", "TV Brasil", "TV C√¢mara", "TV CNN Brasil", "TV Cultura", "TV GloboNews", "TV Jovem Pan News", "TV NBR", "TV Record", "TV Record News", "TV Rede Globo Nacional", "TV RedeTV!", "TV SBT", "TV Senado", "TV Times Brasil CNBC"],
      "R√°dio": ["R√°dio BandNews FM", "R√°dio Bandeirantes FM", "R√°dio CBN FM", "R√°dio Jovem Pan FM", "R√°dio Nacional FM"]
    };
    const veiculoBlogColunaMap = {
      "BBC News Brasil": [],
      "Bloomberg Brasil": [],
      "Bloomberg L√≠nea": [],
      "Brasil 247": [],
      "Carta Capital online": [],
      "CBN": [],
      "CNN Brasil online": [
        "Caio Junqueira", "Clarissa Oliveira", "Gustavo Uribe", "Iuri Pitta",
        "Jussara Soares", "Pedro Venceslau", "Tain√° Falc√£o", "Teo Cury"
      ],
      "Congresso em Foco": ["Opini√£o"],
      "Correio Braziliense online": ["Blog da Denise", "Blog do Vicente", "Blog CB Poder"],
      "Cruso√©": [],
      "Estad√£o online": [
        "Adriano Pires", "Albert Fishlow", "Alexandre Chiavegatto Filho", "Alexandre Schwartsman",
        "Alvaro Gribel", "Ant√¥nio Penteado Mendon√ßa", "Blog do Fausto Macedo", "Bol√≠var Lamounier",
        "Bruno Soller", "Camila Farani", "Carlos Alberto Di Franco", "Carlos Andreazza",
        "Carlos Pereira", "Carolina Br√≠gido", "Celso Lafer", "Celso Ming",
        "Claudio Adilson Gon√ßalez", "Claudio de Moura Castro", "Cl√°udio Considera", "Coluna do Estad√£o",
        "Demi Getschko", "Denis Lerrer Rosenfield", "Diogo Schelp", "Dom Odilo Pedro Scherer",
        "Duquesa de Tax", "E-Investidor", "Eduardo Barretto", "Elena Landau",
        "Eliane Cantanh√™de", "Everardo Maciel", "Fabiano Lana", "F√°bio Alves",
        "Fabio Gallo", "Fabio Giambiagi", "Fausto Macedo", "Felipe Salto",
        "Fernando Dantas", "Fernando Gabeira", "Fernando Henrique Cardoso", "Fernando Sch√ºler",
        "Fl√°vio Tavares", "Francisco Leali", "Gustavo H.B. Franco", "Guy Perelmuter",
        "Henrique Meirelles", "Jorge Caldeira", "Jorge J. Okubaro", "Jos√© M√°rcio Camargo",
        "Jos√© Pastore", "Jos√© Roberto Mendon√ßa de Barros", "Jos√© Serra", "Leticia Fernandes",
        "Luiz Carlos Trabuco Cappi", "Luiz Guilherme Schymura", "Ma√≠lson da N√≥brega", "Manoel Ventura",
        "Marcelo de Paiva Abreu", "Marcelo Trindade", "Marcos Lisboa", "Marcos Troyjo",
        "Maria Cristina Frias", "Maria Herm√≠nia Tavares de Almeida", "Mauro Calliari", "Milton Seligman",
        "Modesto Carvalhosa", "Murillo de Arag√£o", "Nelson Marconi", "Nizan Guanaes",
        "Oscar Vilhena Vieira", "Paulo Furquim de Azevedo", "Paulo Hartung", "Pedro Hallal",
        "Pedro Malan", "Pedro Passos", "Raquel Landim", "Ricardo Musse",
        "Roberto Macedo", "Roberto Rodrigues", "Ronaldo Lemos", "Samuel Pess√¥a",
        "S√©rgio Fausto", "Silvio Meira", "Vera Magalh√£es", "William Waack",
        "Zeina Latif"
      ],
      "Exame on-line": [],
      "Exame online": [],
      "Extra online": [],
      "FDR": [],
      "Folha online": [
        "Afonso Benites", "Alexandre Schwartsman", "Ana Estela Haddad", "Andr√© Lara Resende",
        "Angela Alonso", "Antonio Delfim Netto", "Antonio Prata", "Bernardo Mello Franco",
        "Bruno Boghossian", "Cacique Almir Suru√≠", "Camila Rocha", "Carlos Andreazza",
        "Carlos Melo", "Celso Rocha de Barros", "Christian Dunker", "Claudio Angelo",
        "Conrado H√ºbner Mendes", "Cristina Serra", "Dad√° Coelho", "Dem√©trio Magnoli",
        "Diego Viana", "Djamila Ribeiro", "Edmar Bacha", "Eduardo Giannetti",
        "Eliane Cantanh√™de", "Elias Jabbour", "√ârica Fraga", "Fabio Barbosa",
        "F√°bio Giambiagi", "Felipe Nunes", "Felipe Salto", "Fernando Canzian",
        "Fernando Reinach", "Fernando Sch√ºler", "Flavia Lima", "Gregorio Duvivier",
        "Guilherme Casar√µes", "Gustavo Ioschpe", "H√©lio Schwartsman", "Igor Gielow",
        "Joel Pinheiro da Fonseca", "Jos√© Henrique Mariante", "Juliana Sayuri", "Laura Carvalho",
        "Laura Mattos", "Leandro Karnal", "Lilia Schwarcz", "Luiz Felipe Pond√©",
        "Manoel Ventura", "Marcos Lisboa", "Marcos Nobre", "Maria Herm√≠nia Tavares de Almeida",
        "Maria In√™s Dolci", "Mariliz Pereira Jorge", "Marina Izidro", "Mario Sergio Conti",
        "Martin Wolf", "Maternar", "Mauricio Portugal Ribeiro", "Mauricio Stycer",
        "Mauro Calliari", "Mensageiro Sideral", "Michael Fran√ßa", "Mirian Goldenberg",
        "Mise-en-sc√®ne", "M√¥nica Bergamo", "Morte Sem Tabu", "Muniz Sodr√©",
        "M√∫sculo", "M√∫sica em Letras", "Na√ß√£o churrasqueira", "Natalia Beauty",
        "N√£o Tem Cabimento", "No Corre", "Novo em Folha", "O Mundo √â uma Bola",
        "Oscar Vilhena Vieira", "Outro Canal", "Painel", "Painel das Letras",
        "Painel S.A.", "Papo de Responsa", "Pl√°stico", "Pol√≠ticas e Justi√ßa",
        "Pra√ßa do Leitor", "Pretos Olhares", "Primeira Pele", "Priscilla Bacalhau",
        "Que imposto √© esse", "Reinaldo Jos√© Lopes", "Ricardo Ara√∫jo Pereira", "Roberto Campos Neto",
        "Rodrigo Tavares", "Rog√©rio Gentile", "R√¥mulo Saraiva", "Ronaldo Lemos",
        "Rosana Hermann", "Ross Douthat", "Rui Tavares", "Ruy Castro",
        "Samuel Pess√¥a", "Sa√∫de Mental", "S√©rgio Rodrigues", "Sobre Trilhos",
        "Solange Srour", "Sons da Perifa", "Suzana Herculano-Houzel", "Sylvia Colombo",
        "Tati Bernardi", "Thiago Amparo", "Thiago Stivaletti", "Thomas L. Friedman",
        "Tom Farias", "Tost√£o", "Transpar√™ncia p√∫blica", "Tudo + um pouco",
        "Txai Suru√≠", "Vaiv√©m das Commodities", "Vera Iaconelli", "Vida de Alco√≥latra",
        "Vidas At√≠picas", "Vinicius Mota", "Vinicius Torres Freire", "Virada Psicod√©lica",
        "Wilson Gomes", "X de Sexo por Bruna Maia", "Zeca Camargo"
      ],
      "g1": [
        "Blog da Ana Flor", "Blog do Andr√© Trigueiro", "Blog da Andr√©ia Sadi", "Blog da Camila Bomfim",
        "Blog da Daniela Lima", "Blog do Edimilson √Åvila", "Blog do Gerson Camarotti", "Blog da Julia Duailibi",
        "Blog da Mariza Tavares", "Blog do Mauro Ferreira", "Blog da Natuza Nery", "Blog do Octavio Guedes",
        "Blog Pela Lente da Gente", "Blog da Sandra Cohen", "Blog do Valdo Cruz", "Legendado"
      ],
      "ICL Not√≠cias": [],
      "InfoMoney": [],
      "iG": [],
      "Isto√â Dinheiro online": ["Plat√¥BR"],
      "Isto√â online": ["Plat√¥BR", "Coluna do Mazzini"],
      "Jota": [],
      "Jovem Pan online": [],
      "Metr√≥poles": [
        "Andreza Matais", "Blog do Noblat", "Carlos Carone", "Claudia Meireles",
        "Dinheiro & Neg√≥cios", "F√°bia Oliveira", "Grande Angular", "Igor Gadelha",
        "Ilca Maria Estev√£o", "Isadora Teixeira", "Lilian Tahan", "Mario Sabino",
        "Mirelle Pinheiro", "Paulo Cappelli", "T√°cio Lorran", "Tiago Pavinatto"
      ],
      "Money Times": [],
      "O Antagonista": [],
      "O Bastidor": [],
      "O Globo online": [
        "Ana Carla Abr√£o", "Ancelmo.com", "Ant√¥nio Gois", "Bela Megale",
        "Bernardo Mello Franco", "Bruno Astuto", "Capital", "Carlos Alberto Sardenberg",
        "Carlos Eduardo Mansur", "Carlos G√≥es", "Carlota", "Clima Extremo",
        "Conte mais uma", "Cora R√≥nai", "Correria", "Daniel Becker",
        "Dem√©trio Magnoli", "Diogo Dantas", "Dorrit Harazim", "Eduardo Affonso",
        "Elio Gaspari", "Espiritualidade e Bem-estar", "Fabio Giambiagi", "Fabio Graner",
        "Fernando Gabeira", "Fernando Kall√°s", "Fl√°via Oliveira", "Fumus Boni Iuris",
        "Guga Chacra", "Gustavo Franco", "Gustavo Pinheiro", "Gustavo Poli",
        "IA√≠?", "Ingrid Guimar√£es", "Irapu√£ Santana", "Jana√≠na Figueiredo",
        "Joaquim Ferreira dos Santos", "Jos√© Eduardo Agualusa", "Julia Duailibi", "Julio Maria",
        "Lauro Jardim", "Leo Aversa", "Luana G√©not", "Luciana Fr√≥es",
        "Malu Gaspar", "Manoel Ventura", "Marcelo Barreto", "Marcelo Ninio",
        "Martha Batalha", "Martha Medeiros", "Merval Pereira", "Meus Filhos, Minhas Regras?",
        "Michel Alcoforado", "Miguel de Almeida", "M√≠riam Leit√£o", "Nelson Motta",
        "Pablo Ortellado", "Patr√≠cia Kogut", "Paulo Tafner", "Pedro Doria",
        "Pedro Pac√≠fico", "Pedro Parente", "Pense Grande", "Play",
        "Portugal Giro", "Preto Zez√©", "Priscila Cruz", "Pulso",
        "P√©-Sujo & P√©-Limpo", "Receita de M√©dico", "Renata Agostini", "Repinique",
        "Roberto DaMatta", "Rog√©rio Furquim Werneck", "Ruth de Aquino", "Saideira",
        "Segredos do crime", "Sonar", "Thales Machado", "Tha√≠s Oyama",
        "Thiago Gomide", "Tony Volpon", "Vera Magalh√£es", "Zeina Latif"
      ],
      "Poder360": ["Opini√£o"],
      "R7": ["Christina Lemos", "R7 Planalto"],
      "Terra": [],
      "UOL": [
        "Alexandre Borges", "Alicia Klein", "Amanda Cotrim", "Amanda Klein",
        "Andr√© Santana", "Aline Sordili", "Carla Ara√∫jo", "Carlos Juliano Barros",
        "Carlos Madeiro", "Casagrande", "Danilo Lavieri", "Daniela Lima",
        "Fabio Serapi√£o", "Felipe Salto", "Graciliano Rocha", "Jeferson Ten√≥rio",
        "Joildo Santos", "Josias de Souza", "Josmar Jozino", "Jos√© Fucs",
        "Jos√© Paulo Kupfer", "Jos√© Roberto de Toledo", "Juca Kfouri", "Julio Gomes",
        "Leonardo Sakamoto", "Let√≠cia Casado", "Marco Antonio Sabino", "Mariana Barbosa",
        "Mariana Sanches", "Mauro Cezar", "Milly Lacombe", "Milton Neves",
        "Nat√°lia Portinari", "Nelson de S√°", "Paulo Camargo", "Paulo Vinicius Coelho (PVC)",
        "Presen√ßa Hist√≥rica", "Reinaldo Azevedo", "Ricardo Nunes", "Rodrigo Mattos",
        "Rog√©rio Gentile", "Ronilso Pacheco", "S√≠lvio Crespo", "Thais Bilenky",
        "Thiago Herdy", "Tiago Mali", "Tilt", "Tost√£o",
        "W√°lter Maierovitch"
      ],
      "Valor online": [],
      "Veja online": [
        "Al Vino", "Alexandre Schwartsman", "Balan√ßo Social", "Cannabiz",
        "Conta-Gotas", "Em Cartaz", "Giro pelo Oriente", "Jorge Pontes",
        "Jos√© Casado", "Letra de M√©dico", "Luc√≠lia Diniz", "Luiz Gustavo Bichara",
        "Maquiavel", "Marcela Rahal", "Matheus Leit√£o", "Mens Sana",
        "Mundialista", "Murillo de Arag√£o", "Na Ponta da L√≠ngua", "Neuza Sanches",
        "O Som e a F√∫ria", "Planeta IA", "Radar", "Radar Econ√¥mico",
        "Real Estate", "Tela Plana", "Veja Gente", "Vitrine",
        "Virou Viral"
      ],
      "Yahoo!": []
    };
    const dominioVeiculoMap = {
      "bbc.com": "BBC News Brasil",
      "bloomberg.com.br": "Bloomberg Brasil",
      "bloomberglinea.com.br": "Bloomberg L√≠nea",
      "cartacapital.com.br": "Carta Capital online",
      "correiobraziliense.com.br": "Correio Braziliense online",
      "cnnbrasil.com.br": "CNN Brasil online",
      "oglobo.globo.com": "O Globo online",
      "epocanegocios.globo.com": "√âpoca Neg√≥cios",
      "estadao.com.br": "Estad√£o online",
      "exame.com": "Exame online",
      "folha.uol.com.br": "Folha online",
      "g1.globo.com": "g1",
      "iclnoticias.com.br": "ICL Not√≠cias",
      "infomoney.com.br": "InfoMoney",
      "istoedinheiro.com.br": "Isto√â Dinheiro online",
      "istoe.com.br": "Isto√â online",
      "jota.info": "Jota",
      "metropoles.com": "Metr√≥poles",
      "poder360.com.br": "Poder360",
      "noticias.uol.com.br": "UOL",
      "valor.globo.com": "Valor online",
      "veja.abril.com.br": "Veja online",
      "brasil247.com": "Brasil 247",
      "terra.com.br": "Terra",
      "agenciabrasil.ebc.com.br": "Ag√™ncia Brasil",
      "r7.com": "R7",
      "congressoemfoco.uol.com.br": "Congresso em Foco",
      "oantagonista.com.br": "O Antagonista",
      "crusoe.com.br": "Cruso√©",
      "cbn.globoradio.globo.com": "CBN",
      "valorinveste.globo.com": "Valor Investe",
      "agenciacamara.leg.br": "Ag√™ncia C√¢mara",
      "agenciasenado.leg.br": "Ag√™ncia Senado",
      "extra.globo.com": "Extra online",
      "fdr.com.br": "FDR",
      "ig.com.br": "iG",
      "ultimosegundo.ig.com.br": "iG",
      "jovempan.com.br": "Jovem Pan online",
      "moneytimes.com.br": "Money Times",
      "obastidor.com.br": "O Bastidor",
      "yahoo.com": "Yahoo!",
      "yahoo.com.br": "Yahoo!"
    };
    const orgaosPorCargo = {
      nenhum: ["CAIXA", "CGU", "SRI", "Cultura", "Agricultura", "Desenvolvimento Social", "Comunica√ß√µes", "MME", "CNI", "Turismo", "Embratur", "MPOR", "Esporte"],
      presidente: ["CAIXA", "C√¢mara dos Deputados", "CNI", "Embratur"],
      ministro: ["CGU", "Agricultura", "Desenvolvimento Social", "Comunica√ß√µes", "MME", "Turismo", "MPOR", "Esporte"],
      ministra: ["SRI", "Cultura"]
    };
    const nomeCompletoOrgao = {
      CAIXA: "CAIXA", "C√¢mara dos Deputados": "C√¢mara dos Deputados", CGU: "CGU", CNI: "CNI", SRI: "SRI",
      Cultura: "Minist√©rio da Cultura", Agricultura: "Minist√©rio da Agricultura", "Desenvolvimento Social": "Minist√©rio do Desenvolvimento Social",
      Comunica√ß√µes: "Minist√©rio das Comunica√ß√µes", MME: "MME", Turismo: "Minist√©rio do Turismo", Embratur: "Embratur",
      MPOR: "Portos e Aeroportos", Esporte: "Minist√©rio do Esporte"
    };
    const nomeSimplificadoOrgao = {
      CAIXA: "CAIXA", "C√¢mara dos Deputados": "C√¢mara dos Deputados", CGU: "CGU", CNI: "CNI", SRI: "Rela√ß√µes Institucionais",
      Cultura: "Cultura", Agricultura: "Agricultura", "Desenvolvimento Social": "Desenvolvimento Social",
      Comunica√ß√µes: "Comunica√ß√µes", MME: "Minas e Energia", Turismo: "Turismo", Embratur: "Embratur",
      MPOR: "Portos e Aeroportos", Esporte: "Esporte"
    };
    function saveToLocal(materia) {
      const materias = JSON.parse(localStorage.getItem('materias_clipping_final_v5') || '[]');
      const now = new Date();
      const timestamp = now.toLocaleDateString('pt-BR') + ' ' + now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
      const id = Date.now();
      const novoItem = { id, materia, timestamp };
      materias.push(novoItem);
      localStorage.setItem('materias_clipping_final_v5', JSON.stringify(materias));
      return novoItem;
    }
    function deleteFromLocal(id) {
      let materias = JSON.parse(localStorage.getItem('materias_clipping_final_v5') || '[]');
      materias = materias.filter(item => item.id != id);
      localStorage.setItem('materias_clipping_final_v5', JSON.stringify(materias));
      return true;
    }
    function loadFromLocal() {
      return JSON.parse(localStorage.getItem('materias_clipping_final_v5') || '[]');
    }
    function updateVehicleDropdown(classification) {
      const datalist = document.getElementById("veiculo-dropdown");
      datalist.innerHTML = "";
      const vehiclesToShow = vehiclesByClassification[classification] || [];
      vehiclesToShow.forEach(vehicle => {
        const option = document.createElement("option");
        option.value = vehicle;
        datalist.appendChild(option);
      });
    }
    function updateColumnDropdown(classification, veiculo) {
      const datalist = document.getElementById("coluna-dropdown");
      datalist.innerHTML = "";
      const columns = veiculo ? (veiculoBlogColunaMap[veiculo] || []) : [];
      columns.forEach(column => {
        const option = document.createElement("option");
        option.value = column;
        datalist.appendChild(option);
      });
    }
    function updateMinisterioOptions() {
      const selectedTipoMinistro = tipoMinistroSelect.value;
      const orgaos = orgaosPorCargo[selectedTipoMinistro] || [];
      ministerioSelect.innerHTML = '<option value="">Selecionar o √≥rg√£o</option>';
      orgaos.forEach(orgao => {
        const option = document.createElement("option");
        option.value = orgao;
        option.textContent = orgao;
        ministerioSelect.appendChild(option);
      });
      atualizarTexto();
    }
    function atualizarTexto() {
      const tipoMinistro = tipoMinistroSelect.value;
      const ministerio = ministerioSelect.value;
      let ministerioStr = "";
      let alertaPrefix = "";
      if (ministerio) {
        const nomeComp = nomeCompletoOrgao[ministerio];
        const nomeSimp = nomeSimplificadoOrgao[ministerio];
        if (tipoMinistro === "presidente") {
          ministerioStr = `Presid√™ncia da ${nomeComp}`;
        } else if (tipoMinistro === "ministro") {
          ministerioStr = `Ministro da ${nomeSimp}`;
        } else if (tipoMinistro === "ministra") {
          ministerioStr = `Ministra da ${nomeSimp}`;
        } else {
          ministerioStr = nomeComp;
        }
        if (ministerio === "Comunica√ß√µes") alertaPrefix = "üîî ";
        else if (ministerio === "CGU") alertaPrefix = "üîé ";
        else if (ministerio === "MME") alertaPrefix = "‚ö° ";
        else if (ministerio === "Turismo") alertaPrefix = "‚úàÔ∏è ";
        else if (ministerio === "Embratur") alertaPrefix = "üáßüá∑ ";
        else if (ministerio === "MPOR") alertaPrefix = "‚öì ";
        else if (ministerio === "Esporte") alertaPrefix = "üèÖ ";
      }
      blueParrot.tipoMinistro = tipoMinistro;
      blueParrot.ministerio = ministerio;
      blueParrot.ministerioStr = ministerioStr;
      blueParrot.alertaPrefix = alertaPrefix;
      renderPreview();
    }
    function renderPreview() {
      const classif = blueParrot.classifica√ß√£o.trim();
      const isSingleLine = (classif === "üóû" || classif === "üì∫" || classif === "üìª");
      let html = "";
      html += `<span>${blueParrot.alertaPrefix}</span><strong>ALERTA DE IMPRENSA</strong>`;
      if (blueParrot.ministerioStr) html += ` <span>${blueParrot.ministerioStr}</span>`;
      html += "\n";
      html += `<span>${blueParrot.classifica√ß√£o}</span><strong>${blueParrot.veiculo}</strong>`;
      if (blueParrot.coluna) {
        const colunaLimpa = blueParrot.coluna.replace(/ - _|_$/g, "").trim();
        html += `<span> - ${colunaLimpa}</span>`;
      }
      if (isSingleLine) {
        html += `<span> - _${blueParrot.tags}_</span>`;
      } else {
        html += `\n<span>${blueParrot.tags}</span>`;
      }
      if (blueParrot.linkCurto) html += `\n<span>${blueParrot.linkCurto}</span>`;
      previewArea.innerHTML = html;
    }
    radioButtons.forEach(radio => {
      radio.addEventListener("change", (e) => {
        const val = e.target.value;
        const label = e.target.nextElementSibling.textContent;
        blueParrot.classifica√ß√£o = val + " ";
        updateVehicleDropdown(label);
        renderPreview();
      });
    });
    veiculos.addEventListener("input", (e) => {
      const val = e.target.value.trim();
      blueParrot.veiculo = val ? `*${val}*` : "";
      const classifLabel = document.querySelector("input[name='classificacao']:checked").nextElementSibling.textContent;
      updateColumnDropdown(classifLabel, val);
      renderPreview();
    });
    blogColuna.addEventListener("input", (e) => {
      const val = e.target.value.trim();
      blueParrot.coluna = val ? ` - _${val}_` : "";
      renderPreview();
    });
    tagInput.addEventListener("input", (e) => {
      blueParrot.tags = e.target.value;
      renderPreview();
    });
    linkCurto.addEventListener("input", (e) => {
      const val = e.target.value.trim();
      blueParrot.linkCurto = val;
      renderPreview();
      if (val) processarShortlink(val);
    });
    dataHoraInput.addEventListener("input", (e) => {
      blueParrot.dataHoraPublicacao = e.target.value.trim();
      dataHoraInput.classList.remove("auto-filled");
    });
    tipoMinistroSelect.addEventListener("change", updateMinisterioOptions);
    ministerioSelect.addEventListener("change", atualizarTexto);
    document.getElementById("btn-colar-link").addEventListener("click", async () => {
      try {
        const text = await navigator.clipboard.readText();
        linkCurto.value = text.trim();
        linkCurto.dispatchEvent(new Event('input'));
      } catch (err) { alert("Erro ao acessar √°rea de transfer√™ncia."); }
    });
    document.getElementById("btn-colar-materia").addEventListener("click", async () => {
      try {
        const text = await navigator.clipboard.readText();
        tagInput.value = text.trim();
        tagInput.dispatchEvent(new Event('input'));
      } catch (err) { alert("Erro ao acessar √°rea de transfer√™ncia."); }
    });
    async function processarShortlink(url) {
      loading.style.display = "inline";
      try {
        const { veiculo, coluna } = await identificarVeiculoEColuna(url);
        if (veiculo) {
          veiculos.value = veiculo;
          veiculos.dispatchEvent(new Event('input'));
        }
        if (coluna) {
          blogColuna.value = coluna;
          blogColuna.dispatchEvent(new Event('input'));
        }
        const texto = await extrairConteudo(url);
        tagInput.value = texto;
        tagInput.dispatchEvent(new Event('input'));
        const { dataHora, isExtraida } = await extrairDataHora(url);
        if (dataHora) {
          dataHoraInput.value = dataHora;
          blueParrot.dataHoraPublicacao = dataHora;
          if (isExtraida) {
            dataHoraInput.classList.add("auto-filled");
            blueParrot.dataHoraPublicacaoExtraida = dataHora;
          }
        }
      } catch (e) { console.error(e); }
      finally { loading.style.display = "none"; }
    }
    async function extrairDataHora(url) {
      try {
        const proxyUrl = `https://cors-anywhere.herokuapp.com/${url}`;
        const response = await fetch(proxyUrl, { headers: { "X-Requested-With": "XMLHttpRequest" } });
        const html = await response.text();
        const doc = new DOMParser().parseFromString(html, "text/html");
        let dataHora = "";
        const selectors = [
          'meta[property="article:published_time"]',
          'meta[name="publish-date"]',
          'time[datetime]',
          '.p-time', '.entry-date', '.published-at'
        ];
        for (const s of selectors) {
          const el = doc.querySelector(s);
          if (el) {
            const val = el.getAttribute("datetime") || el.getAttribute("content") || el.innerText;
            if (val) {
              const d = new Date(val);
              if (!isNaN(d.getTime())) {
                dataHora = d.toLocaleDateString('pt-BR') + ' ' + d.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                break;
              }
            }
          }
        }
        return { dataHora, isExtraida: !!dataHora };
      } catch (e) { return { dataHora: "", isExtraida: false }; }
    }
    async function extrairConteudo(url) {
      try {
        const proxyUrl = `https://cors-anywhere.herokuapp.com/${url}`;
        const response = await fetch(proxyUrl, { headers: { "X-Requested-With": "XMLHttpRequest" } });
        const html = await response.text();
        const doc = new DOMParser().parseFromString(html, "text/html");
        ["script", "style", "nav", "footer", "header", "aside", ".ads", ".sidebar"].forEach(s => {
          doc.querySelectorAll(s).forEach(el => el.remove());
        });
        let conteudo = "";
        const selectors = ["article", ".content-body", ".entry-content", ".post-content", "main"];
        for (const s of selectors) {
          const el = doc.querySelector(s);
          if (el) { conteudo = el.innerText; break; }
        }
        if (!conteudo) {
          const todosP = Array.from(doc.querySelectorAll("p"))
            .map(p => p.innerText.trim())
            .filter(t =>
              t.length > 40 &&
              t.split(/\s+/).length > 10 &&
              !t.toLowerCase().includes('gostaria de receber') &&
              !t.toLowerCase().includes('minha folha') &&
              !t.toLowerCase().includes('acessos por dia') &&
              !t.toLowerCase().includes('assinante') &&
              !t.toLowerCase().includes('paywall') &&
              !t.includes('Voc√™ tem') &&
              !t.includes('dar de presente')
            );
          conteudo = todosP.slice(0, 4).join(" ");
        }
        const palavras = conteudo.split(/\s+/);
        if (palavras.length > 140) {
          conteudo = palavras.slice(0, 140).join(" ") + " [...]";
        }
        conteudo = conteudo.replace(/\s+/g, ' ').trim();
        return conteudo.length > 30
          ? conteudo
          : "N√£o foi poss√≠vel extrair texto relevante (poss√≠vel paywall ou p√°gina sem conte√∫do acess√≠vel).";
      } catch (err) {
        console.error("Erro na extra√ß√£o:", err);
        return "Erro ao processar a p√°gina: " + err.message;
      }
    }
    async function identificarVeiculoEColuna(url) {
      let veiculo = "", coluna = "";
      try {
        const urlObj = new URL(url);
        const hostname = urlObj.hostname.toLowerCase();
        for (const [dom, nome] of Object.entries(dominioVeiculoMap)) {
          if (hostname.includes(dom)) { veiculo = nome; break; }
        }
        const path = urlObj.pathname.toLowerCase();
        if (veiculo && veiculoBlogColunaMap[veiculo]) {
          for (const col of veiculoBlogColunaMap[veiculo]) {
            let norm = col.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase()
              .replace("blog da ", "").replace("blog do ", "")
              .replace(/\s+/g, "");
            if (veiculo.includes("Folha")) {
              norm = norm.replace(/-/g, "");
              let pathSemHifen = path.replace(/-/g, "");
              if (pathSemHifen.includes(norm)) {
                coluna = col;
                break;
              }
            } else {
              if (path.includes(norm)) {
                coluna = col;
                break;
              }
            }
          }
        }
        if (!coluna) {
          const proxyUrl = `https://cors-anywhere.herokuapp.com/${url}`;
          const response = await fetch(proxyUrl, { headers: { "X-Requested-With": "XMLHttpRequest" } });
          const html = await response.text();
          const doc = new DOMParser().parseFromString(html, "text/html");
          const author = doc.querySelector('meta[name="author"], meta[property="article:author"]');
          if (author) coluna = author.getAttribute("content");
        }
      } catch (err) {}
      return { veiculo, coluna };
    }
    function determinarClassificacao(veiculo) {
      for (const [cl, list] of Object.entries(vehiclesByClassification)) {
        if (list.includes(veiculo)) {
          if (cl === "Impresso") return "üóû";
          if (cl === "Online Nacional" || cl === "Internacional") return "üåê";
          if (cl === "TV") return "üì∫";
          if (cl === "R√°dio") return "üìª";
        }
      }
      return "üåê";
    }
    document.querySelector(".btn-copiar").addEventListener("click", () => {
      if (!blueParrot.veiculo || !blueParrot.tags) return;
      const classif = blueParrot.classifica√ß√£o.trim();
      const isSingleLine = (classif === "üóû" || classif === "üì∫" || classif === "üìª");
      const isComunicacoes = blueParrot.ministerio === "Comunica√ß√µes"
        && (blueParrot.tipoMinistro === "nenhum" || blueParrot.tipoMinistro === "ministro");
      const isCGU = blueParrot.ministerio === "CGU";
      const veiculoLimpo = blueParrot.veiculo.replace(/^\*+|\*+$/g, '').trim();
      const colunaLimpa = blueParrot.coluna.replace(/^\s*-?\s*_?|_?\s*-?\s*$/g, '').trim();
      let linhaVeiculo = `${classif}*${veiculoLimpo}*`;
      if (colunaLimpa) {
        linhaVeiculo += ` - _${colunaLimpa}_`;
      }
      let linhaComLink = linhaVeiculo;
      if (isComunicacoes && blueParrot.linkCurto) {
        linhaComLink += ` - ${blueParrot.linkCurto}`;
      }
      let materia = "";
      if (isComunicacoes) {
        let dataHoraUsada = blueParrot.dataHoraPublicacao.trim() || blueParrot.dataHoraPublicacaoExtraida.trim();
        if (!dataHoraUsada || !dataHoraUsada.match(/^\d{2}\/\d{2}\/\d{4}(\s+\d{2}:\d{2})?$/)) {
          alert("Para Comunica√ß√µes √© obrigat√≥ria a Data/Hora de Publica√ß√£o (DD/MM/YYYY HH:MM)");
          return;
        }
        if (!dataHoraUsada.includes(":")) dataHoraUsada += " 00:00";
        const [data, hora] = dataHoraUsada.split(" ");
        const [dia, mes, ano] = data.split("/");
        const [hh, mm] = hora.split(":");
        const dateObj = new Date(`${ano}-${mes}-${dia}T${hh}:${mm}:00`);
        const diasSemana = ["Domingo", "Segunda-feira", "Ter√ßa-feira", "Quarta-feira", "Quinta-feira", "Sexta-feira", "S√°bado"];
        const diaSemana = diasSemana[dateObj.getDay()];
        const formattedDateTime = `${diaSemana}, ${dia}/${mes}, ${hh}h${mm}`;
        materia = `üö® *ALERTA DE IMPRENSA* - ${formattedDateTime}\n\n` +
                  `${blueParrot.alertaPrefix}${blueParrot.ministerioStr}\n\n` +
                  `${linhaComLink}\n\n` +
                  `${blueParrot.tags}`;
      } else if (isCGU) {
        const linhas = blueParrot.tags.trim().split('\n').filter(l => l.trim() !== '');
        let conteudoFormatado = "";
        if (linhas.length >= 1) {
          conteudoFormatado += `*${linhas[0].trim()}*\n`;
        }
        if (linhas.length >= 2) {
          conteudoFormatado += `_${linhas[1].trim()}_`;
        }
        if (linhas.length >= 3) {
          conteudoFormatado += `\n${linhas.slice(2).join('\n')}`;
        }
        materia = `${blueParrot.alertaPrefix}*ALERTA DE IMPRENSA* ${blueParrot.ministerioStr ? blueParrot.ministerioStr : ""}\n` +
                  `${linhaVeiculo}\n` +
                  `${conteudoFormatado}\n` +
                  `${blueParrot.linkCurto ? blueParrot.linkCurto : ""}`;
      } else {
        let tempMateria = `${blueParrot.alertaPrefix}*ALERTA DE IMPRENSA*${blueParrot.ministerioStr ? " " + blueParrot.ministerioStr : ""}\n`;
        if (isSingleLine) {
          tempMateria += `${linhaVeiculo.trim()} - _${blueParrot.tags.trim()}_`;
        } else {
          tempMateria += `${linhaVeiculo.trim()}\n${blueParrot.tags.trim()}`;
        }
        if (blueParrot.linkCurto) {
          tempMateria += `\n${blueParrot.linkCurto}`;
        }
        materia = tempMateria;
      }
      navigator.clipboard.writeText(materia).then(() => {
        const data = saveToLocal(materia);
        adicionarMateriaTabela(data.id, materia, data.timestamp);
      });
    });
    document.querySelector(".btn-resetar").addEventListener("click", () => {
      backup = { ...blueParrot };
      veiculos.value = ""; blogColuna.value = ""; tagInput.value = ""; linkCurto.value = "";
      dataHoraInput.value = "";
      dataHoraInput.classList.remove("auto-filled");
      tipoMinistroSelect.value = "nenhum"; ministerioSelect.value = "";
      [veiculos, blogColuna, tagInput, linkCurto, dataHoraInput, tipoMinistroSelect].forEach(el => el.dispatchEvent(new Event('input')));
      updateMinisterioOptions();
    });
    document.querySelector(".btn-desfazer").addEventListener("click", () => {
      if (Object.keys(backup).length) {
        blueParrot = { ...backup };
        veiculos.value = blueParrot.veiculo.replace(/\*/g, "");
        blogColuna.value = blueParrot.coluna.replace(/ - _|_$/g, "").replace(" - ", "");
        tagInput.value = blueParrot.tags;
        linkCurto.value = blueParrot.linkCurto;
        dataHoraInput.value = blueParrot.dataHoraPublicacao;
        dataHoraInput.classList.remove("auto-filled");
        if (blueParrot.dataHoraPublicacaoExtraida) {
          dataHoraInput.classList.add("auto-filled");
        }
        tipoMinistroSelect.value = blueParrot.tipoMinistro;
        updateMinisterioOptions();
        ministerioSelect.value = blueParrot.ministerio;
        [veiculos, blogColuna, tagInput, linkCurto, dataHoraInput, ministerioSelect].forEach(el => el.dispatchEvent(new Event('input')));
      }
    });
    function adicionarMateriaTabela(id, materia, timestamp) {
      const tbody = document.querySelector("#materias-tabela tbody");
      const row = document.createElement("tr");
      row.setAttribute("data-id", id);
      const dataStr = timestamp.split(' ')[0].substring(0, 5) + " - " + timestamp.split(' ')[1] + "h";
      const materiaEscapada = materia
        .replace(/\\/g, '\\\\')
        .replace(/'/g, "\\'")
        .replace(/\n/g, "\\n")
        .replace(/\r/g, "");
      row.innerHTML = `
        <td data-label="Data/Hora">${dataStr}</td>
        <td data-label="Mat√©ria Completa" class="materia-cell">${materia}</td>
        <td data-label="A√ß√µes">
          <button class="btn btn-outline" onclick="copiarTabela('${materiaEscapada}')" title="Copiar mensagem">üîó</button>
          <button class="btn btn-outline" onclick="excluirTabela(${id}, this)" title="Excluir esta mensagem">üóëÔ∏è</button>
        </td>
      `;
      tbody.prepend(row);
    }
    window.copiarTabela = (txt) => {
      try {
        navigator.clipboard.writeText(txt);
      } catch (err) {
        console.error("Erro ao copiar:", err);
        alert("N√£o foi poss√≠vel copiar o texto.");
      }
    };
    window.excluirTabela = (id, btn) => {
      if (confirm("Tem certeza que deseja excluir esta mensagem?")) {
        deleteFromLocal(id);
        btn.closest("tr").remove();
      }
    };
    window.onload = () => {
      updateVehicleDropdown("Online Nacional");
      updateMinisterioOptions();
      const historico = loadFromLocal();
      historico.forEach(item => {
        adicionarMateriaTabela(item.id, item.materia, item.timestamp);
      });
    };
  </script>
</body>
</html>
